---
- name: Install Apache on RHEL 9
  hosts: webserver
  become: yes

  tasks:
    - name: Ensure the python3-dnf package is installed
      dnf:
        name: python3-dnf
        state: present
        use_backend: dnf4

    - name: Install Apache (httpd) package
      dnf:
        name: httpd
        state: present
        use_backend: dnf4

    - name: Ensure Apache (httpd) service is enabled and started
      systemd:
        name: httpd
        state: started
        enabled: yes

    - name: Open HTTP port in the firewall
      firewalld:
        port: 80/tcp
        permanent: yes
        state: enabled

    - name: Reload firewalld to apply changes
      command: firewall-cmd --reload
      become: yes
